# Развертывание Telegram бота на Railway

## Пошаговая инструкция

### 1. Подготовка к развертыванию

1. Убедитесь, что у вас есть аккаунт на [Railway](https://railway.app)
2. Убедитесь, что у вас есть аккаунт на [GitHub](https://github.com)

### 2. Создание репозитория

1. Создайте новый репозиторий на GitHub
2. Загрузите код бота в репозиторий:
   ```bash
   git init
   git add .
   git commit -m "Initial commit: Telegram bot for mop orders"
   git branch -M main
   git remote add origin https://github.com/yourusername/your-repo-name.git
   git push -u origin main
   ```

### 3. Развертывание на Railway

1. Войдите в [Railway](https://railway.app)
2. Нажмите "New Project"
3. Выберите "Deploy from GitHub repo"
4. Выберите ваш репозиторий с ботом
5. Railway автоматически определит, что это Node.js проект

### 4. Настройка переменных окружения

В настройках проекта Railway добавьте переменные:

- `TELEGRAM_BOT_TOKEN` = `8395484296:AAG2EGWRpGxSCqOfrolJjOLDGGch35YDXaI`
- `NODE_ENV` = `production`

### 5. Получение URL приложения

1. После развертывания Railway предоставит URL вашего приложения
2. URL будет выглядеть примерно так: `https://your-app-name.railway.app`
3. Скопируйте этот URL

### 6. Обновление сайта

1. Откройте файл `mop-website/script.js`
2. Найдите строку:
   ```javascript
   const botApiUrl = 'https://your-railway-app-url.railway.app/api/order';
   ```
3. Замените `your-railway-app-url.railway.app` на ваш реальный URL от Railway

### 7. Тестирование

1. Откройте сайт и попробуйте отправить тестовый заказ
2. Проверьте, что бот получает уведомления в Telegram
3. Убедитесь, что кнопки управления заказами работают

### 8. Настройка бота

1. Найдите вашего бота в Telegram по токену
2. Отправьте команду `/start`
3. Теперь бот будет получать все заказы с сайта

## Структура API

### Endpoints

- `POST /api/order` - Отправка нового заказа
- `GET /api/health` - Проверка состояния бота
- `GET /` - Информация об API

### Формат заказа

```json
{
  "name": "Имя клиента",
  "phone": "+7 (999) 123-45-67",
  "email": "client@example.com",
  "address": "Адрес доставки",
  "quantity": "1",
  "payment": "Наличными при получении",
  "comments": "Комментарии к заказу",
  "timestamp": "20.09.2025, 13:35:00",
  "product": "УЛЬТРА ШВАБРА V2 B750002",
  "price": "999 ₽"
}
```

## Мониторинг

Railway предоставляет:
- Логи приложения
- Метрики использования
- Автоматические перезапуски при сбоях

## Обновление бота

Для обновления бота:
1. Внесите изменения в код
2. Зафиксируйте изменения в Git
3. Railway автоматически перезапустит приложение

## Безопасность

- Токен бота хранится в переменных окружения Railway
- API защищен от CORS атак
- Валидация входящих данных
- Обработка ошибок

## Поддержка

При возникновении проблем:
1. Проверьте логи в Railway
2. Убедитесь, что все переменные окружения установлены
3. Проверьте, что бот запущен и отвечает на команды

